<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Giỏ Hàng</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    />

    <!--cnd fontawesome-->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- Theme style -->
    <link rel="stylesheet" href="/css/user/userIndex.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.6.1/font/bootstrap-icons.css"
    />

    <!--slick-->
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"
    />
    <style>
      /* tắt phím tăng giảm của input number */
      input[type="number"]::-webkit-inner-spin-button,
      input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      #cartOrderForm {
        position: sticky;
        bottom: 0px;
        z-index: 9;
      }

      a {
        text-decoration: none;
      }
    </style>
  </head>

  <body>
    <header>
      <div th:replace="~{flagment/user/userHeader :: userHeaderFragment}"></div>
      <div class="container mt-3">
        <div class="row">
          <div class="col-12">
            <span class="content"><a class="path_content">Trang Chủ</a></span>
            <span class="path_arrow">
              <i class="fa-solid fa-chevron-right"></i
            ></span>
            <span class="content"
              ><a class="path_content" th:text="*{brand}"></a
            ></span>
            <span class="path_arrow">
              <i class="fa-solid fa-chevron-right"></i>
            </span>
            <span class="content"
              ><a class="path_content" th:text="*{name}"></a
            ></span>
          </div>
        </div>
      </div>
    </header>
    <main>
      <div class="container">
        <div class="text-dark content_price" style="margin-top: 10px">
          <span
            class="container_main_middle-contten"
            style="color: #2a62b9; margin-left: -25px; font-size: 20px"
            >Giỏ hàng</span
          >
        </div>
      </div>
      <div
        class="container container_main_middle bg-white"
        style="padding: 20px"
      >
        <!-- Lặp qua các shop và sản phẩm -->
        <ng-container *ngFor="let shopId of Object.keys(shopGroups)">
          <div
            class="d-flex justify-content-between gap-3 align-items-center px-3 pt-1"
          >
            <button
              class="d-flex justify-content-start gap-3 align-items-center border-0 bg-transparent"
              type="button"
            >
              <div class="">
                <img
                  alt="Avatar Shop"
                  src="/img/account/{{item.avatarShop}}"
                  class="rounded-circle img-fluid"
                  style="width: 2.5rem"
                />
              </div>
              <!-- Tên shop -->
              <p class="d-flex align-items-center m-0">
                {{ shopGroups[shopId][0].shopName }}
              </p>
            </button>
            <div class="text-center d-flex align-items-center">
              <input
                class="form-check-input m-0"
                type="checkbox"
                value=""
                id="checkAllProdOfShop"
              />
              <button class="btn btn-transparents">Chọn tất cả</button> |
              <button class="btn btn-transparents text-danger">Xóa</button>
            </div>
          </div>
          <!-- Lặp qua các sản phẩm trong cùng một shop -->
          <div class="row px-3 pb-3 pt-2">
            <div class="col-md-12">
              <!--CART -->
              <div
                class="border-0 border-top bg-light"
                *ngFor="let item of shopGroups[shopId]"
              >
                <div class="card-body p-2">
                  <div
                    class="row d-flex justify-content-between align-items-center"
                  >
                    <div
                      class="col-md-2 col-lg-2 col-xl-2 row d-flex justify-content-between align-items-center"
                    >
                      <div class="col-4 pe-0">
                        <input
                          class="form-check-input"
                          type="checkbox"
                          value=""
                          id="flexCheckDefault"
                        />
                      </div>
                      <img
                        style="height: 8rem"
                        src="/img/product/aligqd911/101-aligqd911-10001/ao-khoac-du-surfing-form-regular-ak051_2_small-17999.webp"
                        class="img-fluid rounded-3 p-0 col-8"
                        alt="Cotton T-shirt"
                      />
                    </div>
                    <div class="col-md-3 col-lg-3 col-xl-4">
                      <p class="fw-normal mb-2 card-title tensp">
                        {{ item.name }}
                      </p>
                      <button
                        type="button"
                        class="btn btn-secondary p-1 mb-2 w-100 d-flex justify-content-center"
                      >
                        <div class="m-0 px-3">
                          Size: <span class="text-white">{{ item.size }} </span>
                        </div>
                        <div class="m-0 px-3">
                          Color:
                          <span class="text-white">{{ item.color }}</span>
                        </div>
                      </button>
                      <div class="row">
                        <s class="col-4">{{ item.price | number:'1.0-0' }}$</s>
                        <p class="text-danger fw-bold col-4">
                          {{ item.price | number:'1.0-0' }}$
                        </p>
                      </div>
                    </div>
                    <div class="col-md-3 col-lg-3 col-xl-1 d-flex">
                      <button
                        class="btn btn-link px-2 p-0"
                        onclick="this.parentNode.querySelector('input[type=number]').stepDown()"
                      >
                        <i class="fas fa-minus"></i>
                      </button>

                      <input
                        id="form1"
                        min="0"
                        name="quantity"
                        type="number"
                        class="form-control form-control-sm"
                        style="width: 2rem"
                        inputmode="numeric"
                        [(ngModel)]="item.quantity"
                        onchange="this.cart.changeQty(item.id, 2)"
                      />

                      <button
                        class="btn btn-link px-2 p-0"
                        onclick="this.parentNode.querySelector('input[type=number]').stepUp()"
                      >
                        <i class="fas fa-plus"></i>
                      </button>
                    </div>
                    <div class="col-md-3 col-lg-2 col-xl-2 offset-lg-1">
                      <h5 class="mb-0">
                        {{ (item.price * item.quantity) | number:'1.0-0' }}$
                      </h5>
                    </div>
                    <div class="col-md-1 col-lg-1 col-xl-1 text-end">
                      <a
                        href="javascript:void(0)"
                        ng-click="this.cart.remove(item.id)"
                        class="text-danger"
                        ><i class="fas fa-trash fa-lg"></i
                      ></a>
                    </div>
                  </div>
                </div>
              </div>
              <!--END CART -->
            </div>
          </div>
        </ng-container>
      </div>
      <div
        class="container"
        id="cartOrderForm"
        style="
          background-color: white;
          box-shadow: rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;
          margin-top: 20px;
          border-radius: 10px;
          padding: 20px 10px;
        "
      >
        <div class="row">
          <div class="col-3 chose-all" style="margin: auto 0">
            <label>
              <input
                class="form-check-input"
                type="checkbox"
                value=""
                id="checkAllCart"
              />
            </label>
            <button class="btn btn-transparents" id="btn-chose-all-product">
              Chọn Tất Cả (<span id="cart-count-product">100</span>)
            </button>
          </div>
          <div class="col-6 total-all-product" style="margin: auto 0">
            <p class="mb-0" style="float: right">
              Tổng Thanh Toán (<span id="count-prod-order">2</span> sản phẩm):
              <span id="total-price">1230123</span>@
            </p>
          </div>
          <div class="col-3 order-product">
            <button class="btn btn-primary w-100 p-2" id="btn-order">
              Mua Hàng
            </button>
          </div>
        </div>
      </div>
      <div class="container container_main_middle mt-3 pb-5 bg-white">
        <div class="row mt-3">
          <div class="text-dark content_price">
            <span
              class="container_main_middle-contten mt-3"
              style="color: #2a62b9"
              >Dành Cho Bạn</span
            >
          </div>
        </div>

        <div class="row d-flex justify-content-between align-items-center px-3">
          <div
            class="col-6 col-md-4 col-lg-3 col-xl-2 pt-2"
            th:each="product : ${products}"
          >
            <a
              th:href="@{|/details/${product.id}|}"
              class="text-decoration-none"
            >
              <div class="card pb-2" style="width: 10.8rem">
                <div class="icon-sale text-center pl-5 pr-5 p-1">HOT SALE</div>
                <div
                  class="hot-sale text-center p-1"
                  th:if="${#numbers.formatDecimal(100 - ((product.productVariants[0].priceSale / product.productVariants[0].price) * 100),0,'POINT', 0, 'COMMA')} > 0"
                >
                  Giảm
                  <span
                    th:text="${#numbers.formatDecimal(100 - ((product.productVariants[0].priceSale / product.productVariants[0].price) * 100),0,'POINT', 0, 'COMMA')}"
                  ></span>
                  %
                </div>
                <img
                  th:src="@{|/img/product/${product.sellerProduct.username}/${product.id}/${product.imageProducts[0].name}|}"
                  class="img-fluid w-100 p-0"
                  th:alt="${product.name}"
                />
                <div class="card-body" style="padding: 5px">
                  <div
                    class="card-title tensp text-left"
                    style="height: 40px"
                    th:text="${product.name}"
                    th:title="${product.name}"
                  ></div>
                  <div id="price-box text-left row">
                    <div class="price col-6 m-0" style="text-decoration: none">
                      <span style="color: #ff0821bb">₫</span
                      ><strong
                        class="fs-10"
                        th:text="${#numbers.formatDecimal(product.productVariants[0].priceSale, 0 , 'POINT', 0, 'COMMA')}"
                        style="color: #ff0821bb; font-weight: 600"
                        >8,490,000</strong
                      >
                    </div>
                    <div class="price col-6 m-0" style="text-decoration: none">
                      <s
                        class="fs-11"
                        th:text="${#numbers.formatDecimal(product.productVariants[0].price, 0 , 'POINT', 0, 'COMMA')}"
                        style="color: #3f3d3d; font-weight: 100"
                        ><span style="color: #3f3d3d">₫</span>8,490,000</s
                      >
                    </div>
                  </div>
                  <div
                    class="icon-star text-left"
                    style="text-decoration: none"
                  >
                    <i class="icon-flash text-red"></i>
                    <i class="bi bi-star"></i> <i class="bi bi-star"></i>
                    <i class="bi bi-star"></i> <i class="bi bi-star"></i>
                    <i class="bi bi-star"></i>
                    <p class="text-info m-0">
                      đã bán
                      <i
                        class="text-info m-0"
                        th:text="${product.soldCount}"
                      ></i>
                    </p>
                  </div>
                </div>
              </div>
            </a>
          </div>
        </div>
      </div>
    </main>
    <footer>
      <!-- place footer here -->

      <div
        class="container-fluid mt-3"
        style="
          background: linear-gradient(
            90deg,
            rgba(25, 38, 186, 1) 0%,
            rgba(57, 151, 184, 1) 54%,
            rgba(0, 212, 255, 1) 100%
          );
        "
      >
        <div class="container">
          <div class="row">
            <div class="col-xs-6 col-md-4 col-lg-2 mt-2">
              <span class="footer_title_content"> Hỗ Trợ Khách Khàng</span>
              <ul
                class="list_customers"
                style="list-style-type: none; padding: 0"
              >
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Các Câu Hỏi Thường Gặp</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Gửi Yêu Cầu Hỗ Trợ</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Hướng Dẫn Đặt Hàng</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Phương thức vận chuyển</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Chính Sách Đổi Trả</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Hướng Dẫn Trả Góp</a
                  >
                </li>
              </ul>
            </div>
            <div class="col-xs-6 col-md-4 col-lg-2 mt-2">
              <span class="footer_title_content"> Về Chúng Tôi DEVEX</span>
              <ul
                class="list_customers"
                style="list-style-type: none; padding: 0"
              >
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Giới Thiệu</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Tuyển Dụng</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Chính Sách Bảo Mật Và Thanh Toán</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Bán Hàng Doanh Nghiệp</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Điều Kiện Vận Chuyển</a
                  >
                </li>
              </ul>
            </div>
            <div class="col-xs-6 col-md-4 col-lg-2 mt-2">
              <span class="footer_title_content"> Hợp Tác Và Liên Kết</span>
              <ul
                class="list_customers"
                style="list-style-type: none; padding: 0"
              >
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Hỗ Trợ Khách Khàng</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Hỗ Trợ Khách Khàng</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Hỗ Trợ Khách Khàng</a
                  >
                </li>
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Hỗ Trợ Khách Khàng</a
                  >
                </li>
              </ul>
            </div>
            <div class="col-xs-6 col-md-4 col-lg-3 mt-2">
              <span class="footer_title_content">
                Giao Hàng Và Các Phương Thức Thanh Toán</span
              >
              <ul
                class="list_customers"
                style="list-style-type: none; padding: 0"
              >
                <li>
                  <a href="" class="text-decoration-none text-light"
                    >Hỗ Trợ Khách Khàng</a
                  >
                </li>
              </ul>
            </div>

            <div class="col-xs-6 col-md-4 col-lg-3 mt-2">
              <h3 class="footer_title_content">HOTLINE: **********</h3>
              <ul
                class="list-customers"
                style="list-style-type: none; padding: 0"
              ></ul>
            </div>
          </div>

          <div class="content_footer">
            <div class="row">
              <div class="col-12">
                <div class="row">
                  <span class="text-center content_footer-text"
                    >Trụ sở chính: Tòa nhà Viettel, Số 285, đường Cách Mạng
                    Tháng 8, phường 12, quận 10, Thành phố Hồ Chí Minh DEVEX
                    nhận đặt hàng trực tuyến và giao hàng tận nơi, chưa hỗ trợ
                    mua và nhận hàng trực tiếp tại văn phòng hoặc trung tâm xử
                    lý đơn hàng
                  </span>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-12">
                <div class="row">
                  <span class="text-center content_footer-text"
                    >Giấy chứng nhận Đăng ký Kinh doanh số 0309532909 do Sở Kế
                    hoạch và Đầu tư Thành phố Hồ Chí Minh cấp lần đầu ngày
                    06/01/2010 và sửa đổi lần thứ 23 ngày 14/02/2022
                  </span>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-12">
                <div class="row">
                  <span class="text-center content_footer-text">
                    © 2022 - Bản quyền của Công ty TNHH DEVEX</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script>
      function updateTotalPrice(selectElement) {
        const productContainer = selectElement.closest(".product-container");
        const quantity = parseInt(selectElement.value, 10);
        const priceText = productContainer
          .querySelector(".product-price")
          .innerText.trim();
        const price = parseFloat(priceText.replace(/[^\d.-]/g, ""));
        const totalPrice = quantity * price;
        productContainer.querySelector(".totalPriceValue").innerText =
          totalPrice.toLocaleString("vi-VN");
        productContainer
          .querySelector(".totalPriceValue")
          .setAttribute("data-total-price", totalPrice);
      }
    </script>

    <script th:src="@{/js/cart-ctrl.js}"></script>

    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
      integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
      crossorigin="anonymous"
    ></script>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js"
      integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz"
      crossorigin="anonymous"
    ></script>
    <!--slick slide-->

    <script
      type="text/javascript"
      src="https://code.jquery.com/jquery-1.11.0.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"
    ></script>
    <script src="/static/admin/dist/js/user/userIndex.js"></script>
  </body>
</html>
